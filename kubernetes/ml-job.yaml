apiVersion: batch/v1
kind: Job
metadata:
  name: ml-job
  namespace: gabrielafreitas
spec:
  template:
    metadata:
      labels:
        app: gabrielafreitas-ml-container
    spec:
      containers:
      - name: ml-container
        image: quay.io/gmiserani/playlists-recommender-system-ml:0.3
        env:
        - name: DATASET_URL
          value: /app/datasets/spotify/2023_spotify_ds1.csv
        - name: OUTPUT_PATH
          value: /model/recommendation_rules.pkl
        volumeMounts:
        - name: datasets-volume
          mountPath: /app/datasets
        - name: persistent-storage
          mountPath: /model
      volumes:
      - name: datasets-volume
        hostPath:
          path: /home/datasets
          type: Directory
      - name: persistent-storage
        persistentVolumeClaim:
          claimName: playlist-recommender-pvc-gabrielafreitas
      restartPolicy: Never
